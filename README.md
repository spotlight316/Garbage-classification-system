\# 垃圾分类识别系统



\## 项目概述



这是一个基于深度学习的垃圾分类识别系统，使用PyTorch框架和ResNet50模型进行图像分类。系统包含数据预处理、模型训练和图形界面推理三个核心模块，能够通过摄像头实时捕获图像并进行垃圾类别识别。



\## 功能特性



\- \*\*数据预处理\*\*: 自动划分训练集和验证集

\- \*\*模型训练\*\*: 使用预训练的ResNet50模型进行迁移学习

\- \*\*数据增强\*\*: 应用多种图像增强技术提高模型泛化能力

\- \*\*实时识别\*\*: 通过摄像头实时捕获图像并进行分类

\- \*\*图形界面\*\*: 使用PyQt5开发的用户友好界面

\- \*\*模型保存\*\*: 自动保存最佳性能的模型权重



\## 项目结构



```

.

├── dataset\_split.py      # 数据集划分脚本

├── lajifenlei.py         # 模型训练脚本

├── main.py              # 图形界面应用程序

├── trash/               # 原始数据集目录(需手动创建)

├── waste\_big/           # 处理后的数据集目录(自动生成)

│   ├── train/           # 训练集

│   └── valid/           # 验证集

└── models/              # 模型保存目录(自动生成)

&nbsp;   └── model\_waste\_50\_best.pth  # 最佳模型权重

```



\## 环境要求



\### 硬件要求

\- 支持CUDA的GPU(推荐)或CPU

\- 摄像头(用于实时识别)



\### 软件要求

\- Python 3.7+

\- PyTorch 1.8+

\- torchvision

\- OpenCV

\- PyQt5

\- PIL/Pillow

\- tqdm



\### 安装依赖



```bash

pip install torch torchvision opencv-python PyQt5 Pillow tqdm

```



\## 使用方法



\### 1. 准备数据



将垃圾分类图像数据按类别组织在`trash`目录下，每个子目录代表一个类别：



```

trash/

├── 类别1/

│   ├── image1.jpg

│   └── image2.jpg

├── 类别2/

│   ├── image1.jpg

│   └── image2.jpg

└── ...

```



\### 2. 划分数据集



运行以下命令将数据集划分为训练集和验证集：



```bash

python dataset\_split.py

```



默认情况下，训练集占80%，验证集占20%。



\### 3. 训练模型



运行以下命令开始训练模型：



```bash

python lajifenlei.py

```



训练过程中会显示进度条和准确率信息，最佳模型将自动保存到`models/model\_waste\_50\_best.pth`。



\### 4. 使用图形界面



运行以下命令启动图形界面应用程序：



```bash

python main.py

```



界面操作步骤：

1\. 点击"打开摄像头"按钮启动摄像头

2\. 调整物品位置使其在画面中清晰可见

3\. 点击"识别"按钮进行垃圾分类

4\. 识别结果将显示在界面中



\## 技术细节



\### 模型架构

\- 使用ResNet50作为基础模型

\- 冻结所有预训练层，只训练最后的全连接层

\- 输出层调整为245个类别(可根据实际类别数量调整)



\### 数据增强

训练时使用多种数据增强技术：

\- 随机旋转(±45度)

\- 随机水平和垂直翻转

\- 颜色抖动(亮度、对比度、饱和度和色调)

\- 中心裁剪和尺寸调整

\- 标准化(使用ImageNet的均值和标准差)



\### 训练参数

\- 学习率: 0.1

\- 优化器: Adam

\- 损失函数: 交叉熵损失

\- 批次大小: 64

\- 训练轮数: 可调整(默认为3轮)



\## 注意事项



1\. 确保原始数据集的目录结构正确

2\. 训练前确认GPU可用(如需要)

3\. 图形界面需要摄像头支持

4\. 模型文件(`model\_waste\_50\_best.pth`)需要与main.py在同一目录或指定正确路径（路径里没有中文字符）

5\. 类别数量需要与数据集实际类别数一致



\## 自定义配置



\### 调整数据集划分比例

在`dataset\_split.py`中修改`train\_scale`和`test\_scale`参数：



```python

data\_set\_split(src\_data\_folder, target\_data\_folder, train\_scale=0.7, test\_scale=0.3)

```



\### 调整训练参数

在`lajifenlei.py`中修改以下参数：

\- `epochs`: 训练轮数

\- `batch\_size`: 批次大小

\- 学习率和其他优化器参数



\### 修改模型架构

可以替换为其他预训练模型(如ResNet152)：



```python

from torchvision.models import resnet152, ResNet152\_Weights

model = resnet152(weights=ResNet152\_Weights.DEFAULT)

```



\## 常见问题



1\. \*\*内存不足\*\*: 减少批次大小或使用更小的模型

2\. \*\*摄像头无法打开\*\*: 检查摄像头权限和连接

3\. \*\*识别准确率低\*\*: 增加训练数据量或调整数据增强策略

4\. \*\*类别数量不匹配\*\*: 确保模型输出层与实际类别数一致



\## 性能优化建议



1\. 使用GPU加速训练和推理

2\. 使用更大的预训练模型提高准确率

3\. 增加数据增强多样性

4\. 使用学习率调度器

5\. 实施早停策略防止过拟合



\## 扩展功能



1\. 添加模型评估脚本

2\. 实现批量图像识别

3\. 添加模型解释性可视化

4\. 支持多种模型架构

5\. 添加模型性能监控



\## 许可证



本项目经作者允许后可供学习和开源。



\## 更新日志



\- 初始版本: 实现基本的数据处理、训练和识别功能

\- 后续计划: 添加模型压缩、多模型支持、Web部署等功能



---



如有问题或建议，请提交Issue或联系项目维护者，2393854395@qq.com

